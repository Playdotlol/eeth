<!DOCTYPE html>
<html lang="en" class="bg-gray-900 text-gray-100">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CyberEmulator</title>

  <!-- EmulatorJS Config (PRE-LOAD) -->
  <script>
    EJS_player = "#emulator";
    EJS_gamepadSupport = true;
    EJS_fullscreenOnLoaded = false;
    EJS_multitap = false;
    EJS_mouse = false;
    EJS_pathtodata = "https://cdn.emulatorjs.org/stable/data/";
  </script>
  <script src="https://cdn.emulatorjs.org/stable/data/loader.js"></script>

  <!-- Tailwind & Custom Styles -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .game-card:hover .overlay { opacity: 1; }
    .game-card { position: relative; overflow: hidden; border-radius: 0.75rem; }
    .overlay { @apply absolute inset-0 bg-black bg-opacity-50 opacity-0 transition-opacity flex flex-col justify-center items-center text-center p-4; }
  </style>
</head>
<body class="flex flex-col items-center p-6 space-y-6 min-h-screen bg-gray-900 text-gray-100">

  <h1 class="text-4xl font-bold text-cyan-400">üéÆ CyberEmulator</h1>

  <!-- Game Grid -->
  <div id="gameGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 max-w-6xl w-full"></div>

  <!-- Upload -->
  <div class="flex items-center space-x-2">
    <input id="romInput" type="file" accept=".nes,.gb,.gba,.sfc,.z64" class="text-black"/>
    <button id="uploadBtn" class="bg-cyan-600 text-black px-5 py-2 rounded font-bold hover:bg-cyan-500">Play Upload</button>
  </div>

  <!-- Controls -->
  <div class="flex flex-wrap justify-center gap-2">
    <button onclick="EJS_fullscreen()" class="control-btn">üñ•Ô∏è Fullscreen</button>
    <button onclick="EJS_saveState()" class="control-btn">üíæ Save</button>
    <button onclick="EJS_loadState()" class="control-btn">üìÇ Load</button>
    <button onclick="resetEmu()" class="control-btn">üîÑ Reset</button>
    <button onclick="settings.classList.toggle('hidden')" class="control-btn">‚öôÔ∏è Settings</button>
  </div>

  <!-- Settings -->
  <div id="settings" class="hidden bg-gray-800 rounded-lg p-4 max-w-lg w-full space-y-4">
    <label>Theme:
      <select onchange="setTheme(this.value)" class="ml-2 text-black rounded px-2 py-1">
        <option>dark</option>
        <option>light</option>
      </select>
    </label>
    <label>Emulator Size:
      <select onchange="setSize(this.value)" class="ml-2 text-black rounded px-2 py-1">
        <option>default</option>
        <option>small</option>
        <option>large</option>
      </select>
    </label>
  </div>

  <!-- Emulator Screen -->
  <div id="emulator" class="w-full max-w-4xl h-80 border-4 border-cyan-500 rounded-xl shadow-lg"></div>

  <script>
    const games = [
      {title:"Donkey Kong (NES)",core:"nes",url:"https://cdn.emulatorjs.org/stable/roms/nes/donkeykong.nes",img:"https://upload.wikimedia.org/wikipedia/en/3/3b/Donkey_Kong_cover.png"},
      {title:"Tetris (GB)",core:"gb",url:"https://cdn.emulatorjs.org/stable/roms/gb/tetris.gb",img:"https://upload.wikimedia.org/wikipedia/en/7/7c/Tetris_Boxshot.jpg"},
      {title:"Dr. Mario (GBA)",core:"gba",url:"https://cdn.emulatorjs.org/stable/roms/gba/DrMario.gba",img:"https://upload.wikimedia.org/wikipedia/en/7/7c/Dr._Mario_box_art.jpg"},
      {title:"DK Country (SNES)",core:"snes",url:"https://cdn.emulatorjs.org/stable/roms/snes/dkc.smc",img:"https://upload.wikimedia.org/wikipedia/en/4/4e/DonkeyKongCountry_SNESboxart.jpg"},
      {title:"Mario Kart (GBA)",core:"gba",url:"https://cdn.emulatorjs.org/stable/roms/gba/mk.gba",img:"https://upload.wikimedia.org/wikipedia/en/f/fb/Mario_Kart_Super_Circuit_boxart.jpg"},
      {title:"Metroid (NES)",core:"nes",url:"https://cdn.emulatorjs.org/stable/roms/nes/metroid.nes",img:"https://upload.wikimedia.org/wikipedia/en/2/2e/Metroid_box.jpg"}
    ];

    const grid = document.getElementById("gameGrid");
    games.forEach(g => {
      const d = document.createElement("div");
      d.className = "game-card bg-gray-800 shadow-lg";
      d.innerHTML = `
        <img src="${g.img}" class="w-full h-40 object-cover"/>
        <div class="overlay">
          <h3 class="text-lg font-semibold mb-2">${g.title}</h3>
          <button class="bg-cyan-500 hover:bg-cyan-400 text-black px-4 py-2 rounded font-bold">Play</button>
        </div>`;
      d.querySelector("button").onclick = () => startGame(g.core, g.url);
      grid.appendChild(d);
    });

    document.getElementById("uploadBtn").onclick = () => {
      const f = document.getElementById("romInput").files[0];
      if(!f) return alert("Select ROM");
      const ext = f.name.split('.').pop().toLowerCase();
      const map = {nes:"nes",gb:"gb",gba:"gba",sfc:"snes",smc:"snes",n64:"n64",z64:"n64"};
      if(!map[ext]) return alert("Unsupported format");
      startGame(map[ext], URL.createObjectURL(f));
    };

    function startGame(core,url) {
      document.getElementById("emulator").innerHTML = "";
      EJS_core = core; EJS_gameUrl = url;
      EJS_start();
    }

    function resetEmu() { document.getElementById("emulator").innerHTML = ""; }
    function setTheme(v) {
      document.documentElement.className = v==="light" ? "bg-white text-black" : "bg-gray-900 text-gray-100";
    }
    function setSize(v) {
      const e = document.getElementById("emulator");
      e.classList.remove("h-64","h-96","h-80");
      e.classList.add(v==="small"?"h-64":v==="large"?"h-96":"h-80");
    }
  </script>
</body>
</html>
