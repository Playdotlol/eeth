<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-950 text-white">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberEmulator</title>
  <script src="https://cdn.jsdelivr.net/gh/ethanaeris/EmulatorJS@latest/loader.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .control-btn {
      background-color: #1f2937;
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      color: white;
      margin: 0.25rem;
    }
    .control-btn:hover {
      background-color: #374151;
    }
    .game-thumb {
      width: 100%;
      object-fit: contain;
      border-radius: 0.5rem;
    }
  </style>
</head>
<body class="flex flex-col items-center justify-start min-h-screen p-6 space-y-6">

  <header class="text-center space-y-2">
    <h1 class="text-5xl font-extrabold text-cyan-400 drop-shadow-lg">üéÆ CyberEmulator</h1>
    <p class="text-gray-400">Play NES, SNES, GB, GBA, and N64 games in your browser!</p>
  </header>

  <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full max-w-5xl">
    <!-- Game Cards injected via JS -->
    <template id="game-card-template">
      <div class="bg-gray-800 rounded-lg shadow-lg p-4 flex flex-col justify-between">
        <img class="game-thumb mb-4 mx-auto" src="" alt="Game thumbnail">
        <h2 class="game-title text-xl font-bold mb-2 text-center"></h2>
        <button class="play-btn bg-cyan-500 hover:bg-cyan-600 px-4 py-2 rounded font-bold">Play</button>
      </div>
    </template>

    <!-- Upload Custom ROM -->
    <div class="bg-gray-800 rounded-lg shadow-lg p-4 flex flex-col items-center">
      <label class="mb-4 font-medium">‚¨ÜÔ∏è Upload Your ROM:</label>
      <input id="romInput" type="file" accept=".nes,.gb,.gbc,.gba,.sfc,.smc,.z64,.n64" class="text-black" />
      <button id="uploadPlayBtn" class="mt-4 bg-cyan-500 hover:bg-cyan-600 px-4 py-2 rounded font-bold">Play Upload</button>
    </div>
  </section>

  <div class="flex gap-2 flex-wrap justify-center">
    <button onclick="EJS_fullscreen()" class="control-btn">üñ•Ô∏è Fullscreen</button>
    <button onclick="EJS_saveState()" class="control-btn">üíæ Save</button>
    <button onclick="EJS_loadState()" class="control-btn">üìÇ Load</button>
    <button onclick="resetEmu()" class="control-btn">üîÑ Reset</button>
  </div>

  <div id="emulator" class="w-full max-w-5xl border-4 border-cyan-500 rounded-xl overflow-hidden shadow-lg"></div>

  <script>
    const presetGames = [
      { title: "Donkey Kong (NES)", core: "nes", url: "https://cdn.jsdelivr.net/gh/ethanaeris/EmulatorJS@main/roms/nes/donkeykong.nes", thumb:"https://via.placeholder.com/150?text=DK+NES" },
      { title: "Tetris (GB)", core: "gb", url: "https://cdn.jsdelivr.net/gh/ethanaeris/EmulatorJS@main/roms/gb/tetris.gb", thumb:"https://via.placeholder.com/150?text=Tetris+GB" },
      { title: "Dr. Mario (GBA)", core: "gba", url: "https://cdn.jsdelivr.net/gh/ethanaeris/EmulatorJS@main/roms/gba/DrMario.gba", thumb:"https://via.placeholder.com/150?text=Dr+Mario+GBA" },
      { title: "Donkey Kong Country (SNES)", core: "snes", url: "https://cdn.jsdelivr.net/gh/ethanaeris/EmulatorJS@main/roms/snes/dkc.smc", thumb:"https://via.placeholder.com/150?text=DKC+SNES" },
      { title: "Super Mario 64 (N64)", core: "n64", url: "roms/super-mario-64.z64", thumb:"https://via.placeholder.com/150?text=SM64+N64" },
    ];

    const emulatorEl = document.getElementById("emulator");
    const container = document.querySelector("section");

    // Load game cards
    presetGames.forEach((g) => {
      const card = document.getElementById("game-card-template").content.cloneNode(true);
      card.querySelector(".game-title").textContent = g.title;
      card.querySelector(".game-thumb").src = g.thumb;
      card.querySelector(".play-btn").onclick = () => startGame(g);
      container.appendChild(card);
    });

    // Upload handler
    document.getElementById("uploadPlayBtn").onclick = async () => {
      const file = document.getElementById("romInput").files[0];
      if (!file) return alert("Select a ROM first");
      const buffer = await file.arrayBuffer();
      const blobUrl = URL.createObjectURL(new Blob([buffer]));
      const ext = file.name.split('.').pop().toLowerCase();
      const core = { nes:"nes", gb:"gb", gbc:"gbc", gba:"gba", smc:"snes", sfc:"snes", n64:"n64", z64:"n64" }[ext];
      if (!core) return alert("Unsupported file type.");
      startGame({ core, url: blobUrl });
    };

    function startGame({ core, url }) {
      EJS_player = "#emulator";
      EJS_core = core;
      EJS_gameUrl = url;
      EJS_gamepadSupport = true;
      EJS_multitap = false;
      EJS_lightgun = false;
      EJS_mouse = false;
      EJS_start();
    }

    function resetEmu() {
      emulatorEl.innerHTML = "";
    }
  </script>

  <p class="text-sm text-gray-500 mt-10 text-center px-4">
    CyberEmulator uses EmulatorJS. Only public or homebrew ROMs are provided. To play commercial games like Super Mario 64, upload your own ROM file to <code>/roms</code>.
  </p>

</body>
</html>
